{% extends "base.html" %}

{% block title %}{{ config.COIN_NAME }} Blockchain Explorer{% endblock %}

{% block content %}
<div class="community-links">
    <a href="https://github.com/elvisjedusor/bitok" target="_blank" rel="noopener" class="community-btn">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
        GitHub
    </a>
    <a href="https://bitcointalk.org/index.php?topic=5571165.0" target="_blank" rel="noopener" class="community-btn bitcointalk">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.472 2.263c-4.655 0-8.49 3.516-8.49 7.86 0 1.09.235 2.13.663 3.073-.428 1.307-1.13 2.456-1.13 2.456s1.96-.105 3.357-.79c1.515.89 3.35 1.42 5.32 1.42.38 0 .755-.02 1.124-.06-.103-.404-.16-.826-.16-1.262 0-3.38 2.99-6.12 6.68-6.12.333 0 .66.023.98.067-.4-3.725-3.815-6.644-7.344-6.644zm-3.15 5.99c.636 0 1.152.516 1.152 1.152s-.516 1.152-1.152 1.152-1.152-.516-1.152-1.152.516-1.152 1.152-1.152zm5.3 0c.636 0 1.152.516 1.152 1.152s-.516 1.152-1.152 1.152-1.152-.516-1.152-1.152.516-1.152 1.152-1.152zm4.95 3.267c-3.19 0-5.78 2.23-5.78 4.98s2.59 4.98 5.78 4.98c1.61 0 3.065-.58 4.17-1.52 1.15.44 2.63.52 2.63.52s-.55-.88-.88-1.88c.33-.7.51-1.48.51-2.31 0-2.75-2.59-4.77-5.78-4.77h-.65zm-1.58 3.1c.53 0 .96.43.96.96s-.43.96-.96.96-.96-.43-.96-.96.43-.96.96-.96zm3.35 0c.53 0 .96.43.96.96s-.43.96-.96.96-.96-.43-.96-.96.43-.96.96-.96z"/></svg>
        BitcoinTalk
    </a>
</div>

<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-label">Block Height</div>
        <div class="stat-value" id="stat-height">{{ stats.height | default(0) | int }}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Difficulty</div>
        <div class="stat-value" id="stat-difficulty">{{ "%.4f" | format(stats.difficulty | default(0)) }}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Transactions</div>
        <div class="stat-value" id="stat-txs">{{ "{:,}".format(stats.total_txs | default(0)) }}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Network Hashrate</div>
        <div class="stat-value" id="stat-hashrate">{{ stats.hashrate_formatted | default('0 H/s') }}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Network Connections</div>
        <div class="stat-value" id="stat-connections">{{ stats.connections | default(0) }}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Sync Status</div>
        <div class="stat-value" id="stat-sync">
            {% if stats.height == stats.chain_height %}
            <span class="badge badge-success">Synced</span>
            {% else %}
            <span class="badge badge-warning">{{ stats.height }}/{{ stats.chain_height }}</span>
            {% endif %}
        </div>
    </div>
</div>

<div class="intro-section">
    <div class="intro-content">
        <p class="intro-lead">What if Bitcoin had stayed CPU-mineable with complete Satoshi-era codebase? No features added. No ideology injected. No attempt to "fix" Bitcoin according to modern tastes.</p>

        <p class="intro-text">I've been running an experiment - the original v0.3.19 codebase, the last release under Satoshi's direct involvement. The same rules. The same behavior. One major change: a mining algorithm that GPUs and ASICs can't easily dominate. All critical security fixes in place from day one. Adapted only as much as required to run on modern operating systems and <strong>resist GPU mining</strong>.</p>

        <div class="intro-cta">
            <a href="/docs" class="intro-btn">Documents</a>
            <a href="/download" class="intro-btn intro-btn-secondary">Download</a>
        </div>
    </div>
</div>

<div class="home-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
    <div class="card">
        <h2 class="card-title">Recent Blocks</h2>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Height</th>
                        <th>Hash</th>
                        <th>Txs</th>
                        <th>Age</th>
                    </tr>
                </thead>
                <tbody id="blocks-table">
                    {% for block in recent_blocks %}
                    <tr>
                        <td><a href="/block/{{ block.height }}">{{ block.height }}</a></td>
                        <td class="hash truncate"><a href="/block/{{ block.hash }}">{{ block.hash[:16] }}...</a></td>
                        <td>{{ block.tx_count }}</td>
                        <td>{{ block.timestamp | age }}</td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="4" style="text-align: center; color: #666;">No blocks yet. Start the sync process.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div style="margin-top: 15px; text-align: center;">
            <a href="/blocks">View all blocks</a>
        </div>
    </div>

    <div class="card">
        <h2 class="card-title">Recent Transactions</h2>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>TxID</th>
                        <th>Block</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody id="txs-table">
                    {% for tx in recent_txs %}
                    <tr>
                        <td class="hash truncate"><a href="/tx/{{ tx.txid }}">{{ tx.txid[:16] }}...</a></td>
                        <td><a href="/block/{{ tx.block_height }}">{{ tx.block_height }}</a></td>
                        <td>{{ tx.total_output | coin }} {{ config.COIN_SYMBOL }}</td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="3" style="text-align: center; color: #666;">No transactions yet.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
function formatNumber(num) {
    return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

function updateHomePage() {
    fetch('/api/home')
        .then(response => response.json())
        .then(data => {
            document.getElementById('stat-height').textContent = data.stats.height;
            document.getElementById('stat-difficulty').textContent = data.stats.difficulty.toFixed(4);
            document.getElementById('stat-txs').textContent = formatNumber(data.stats.total_txs);
            document.getElementById('stat-hashrate').textContent = data.stats.hashrate_formatted;
            document.getElementById('stat-connections').textContent = data.stats.connections;

            if (data.stats.synced) {
                document.getElementById('stat-sync').innerHTML = '<span class="badge badge-success">Synced</span>';
            } else {
                document.getElementById('stat-sync').innerHTML = '<span class="badge badge-warning">' + data.stats.height + '/' + data.stats.chain_height + '</span>';
            }

            var blocksHtml = '';
            if (data.recent_blocks.length === 0) {
                blocksHtml = '<tr><td colspan="4" style="text-align: center; color: #666;">No blocks yet. Start the sync process.</td></tr>';
            } else {
                data.recent_blocks.forEach(function(block) {
                    blocksHtml += '<tr>';
                    blocksHtml += '<td><a href="/block/' + block.height + '">' + block.height + '</a></td>';
                    blocksHtml += '<td class="hash truncate"><a href="/block/' + block.hash + '">' + block.hash.substring(0, 16) + '...</a></td>';
                    blocksHtml += '<td>' + block.tx_count + '</td>';
                    blocksHtml += '<td>' + block.age + '</td>';
                    blocksHtml += '</tr>';
                });
            }
            document.getElementById('blocks-table').innerHTML = blocksHtml;

            var txsHtml = '';
            if (data.recent_txs.length === 0) {
                txsHtml = '<tr><td colspan="3" style="text-align: center; color: #666;">No transactions yet.</td></tr>';
            } else {
                data.recent_txs.forEach(function(tx) {
                    txsHtml += '<tr>';
                    txsHtml += '<td class="hash truncate"><a href="/tx/' + tx.txid + '">' + tx.txid.substring(0, 16) + '...</a></td>';
                    txsHtml += '<td><a href="/block/' + tx.block_height + '">' + tx.block_height + '</a></td>';
                    txsHtml += '<td>' + tx.total_output + ' ' + data.coin_symbol + '</td>';
                    txsHtml += '</tr>';
                });
            }
            document.getElementById('txs-table').innerHTML = txsHtml;
        })
        .catch(function(error) {
            console.error('Error updating data:', error);
        });
}

setInterval(updateHomePage, 10000);
</script>

<style>
.intro-section {
    background: linear-gradient(135deg, #f9f9f9 0%, #ffffff 100%);
    border: 2px solid #c59000;
    border-radius: 4px;
    padding: 35px 40px;
    margin: 30px 0;
    box-shadow: 0 2px 8px rgba(197, 144, 0, 0.1);
}

.intro-content {
    max-width: 900px;
    margin: 0 auto;
}

.intro-lead {
    font-size: 19px;
    line-height: 1.7;
    color: #222;
    margin: 0 0 20px 0;
    font-weight: 600;
    text-align: center;
    padding-bottom: 20px;
    border-bottom: 1px solid #ddd;
}

.intro-text {
    font-size: 15px;
    line-height: 1.75;
    color: #444;
    margin: 0 0 15px 0;
    text-align: justify;
}

.intro-text strong {
    color: #c59000;
    font-weight: bold;
}

.intro-cta {
    display: flex;
    gap: 12px;
    justify-content: center;
    margin-top: 28px;
    padding-top: 20px;
    border-top: 1px solid #ddd;
}

.intro-btn {
    display: inline-block;
    padding: 12px 32px;
    background: linear-gradient(to bottom, #d4a000, #c59000);
    color: #fff;
    text-decoration: none;
    border: 1px solid #a07800;
    border-radius: 4px;
    font-weight: bold;
    font-size: 15px;
    transition: all 0.2s;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.intro-btn:hover {
    background: linear-gradient(to bottom, #c59000, #b58900);
    text-decoration: none;
    color: #fff;
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.intro-btn-secondary {
    background: linear-gradient(to bottom, #f5f5f5, #e8e8e8);
    color: #333;
    border-color: #999;
}

.intro-btn-secondary:hover {
    background: linear-gradient(to bottom, #e8e8e8, #ddd);
    color: #333;
}

@media (max-width: 900px) {
    .intro-section {
        padding: 25px 20px;
        margin: 20px 0;
    }

    .intro-lead {
        font-size: 17px;
        text-align: left;
        padding-bottom: 15px;
    }

    .intro-text {
        font-size: 14px;
        text-align: left;
    }

    .intro-cta {
        flex-direction: column;
        margin-top: 20px;
        padding-top: 15px;
    }

    .intro-btn {
        width: 100%;
        text-align: center;
        padding: 14px 24px;
    }
}

@media (max-width: 480px) {
    .intro-section {
        padding: 20px 15px;
        border-width: 1px;
    }

    .intro-lead {
        font-size: 16px;
        line-height: 1.6;
    }

    .intro-text {
        font-size: 13px;
        line-height: 1.7;
    }

    .intro-btn {
        font-size: 14px;
        padding: 12px 20px;
    }
}
</style>
{% endblock %}
